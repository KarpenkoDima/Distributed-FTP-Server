# MVP FTP Server

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é **FTP-—Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ .NET C# —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –±—É–¥—É—â–µ–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–µ FTPS**. –ü—Ä–æ–µ–∫—Ç —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–¥—Ä–∞ FTP-—Å–µ—Ä–≤–µ—Ä–∞ –∏ —Å–µ—Ä–≤–∏—Å–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É—è –∏—Ö —Å –≥–æ—Ç–æ–≤—ã–º–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏ –¥–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏, —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ—Å—Å–∏–π –∏ —Ñ–∞–π–ª–æ–≤ (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è).

## üìÑ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

* [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Å–∏—Å—Ç–µ–º–Ω—ã–π –¥–∏–∑–∞–π–Ω](docs/ArchitectureDesign.md)
* [–ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏](docs/DevelopmentPlan.md)

## üß© –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

* **FtpServer.Core:** –û—Å–Ω–æ–≤–Ω–æ–µ —è–¥—Ä–æ FTP-—Å–µ—Ä–≤–µ—Ä–∞.
* **FtpServer.Auth:** –°–µ—Ä–≤–∏—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞ ASP.NET Core Web API.
* **FtpServer.Commons:** –û–±—â–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∫–ª–∞—Å—Å–æ–≤ –¥–ª—è –º–æ–¥–µ–ª–µ–π (DTO) –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏.
* **–°—Ç–æ—Ä–æ–Ω–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è:** nginx, Redis, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞.

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

FtpServerMVP/
‚îú‚îÄ‚îÄ docker/                   # Dockerfiles, conf-files for redis, nginx
‚îú‚îÄ‚îÄ FtpServer.Core/           # –û—Å–Ω–æ–≤–Ω–æ–π FTP —Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ FtpServer.Auth/           # Authentication API  
‚îî‚îÄ‚îÄ FtpServer.Commons		  # Shared models/interfaces

## –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã
### –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤: –¢–µ—Å—Ç–∏—Ä—É–µ–º –∑–∞–ø—É—Å–∫ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ä—Ç–∞—Ö:

	–í appsettings.json –∏–∑–º–µ–Ω–∏—Ç—å –Ω–æ–º–µ—Ä –ø–æ—Ä—Ç–∞ 
```bash
	   cd FtpServer.Core 
	   dotnet run
```
	
```bash
	   cd FtpServer.Auth 
	   dotnet run
```
```bash
# –ö —Å–µ—Ä–≤–µ—Ä—É –Ω–∞ –ø–æ—Ä—Ç—É 2121
echo -e "USER demo\nPASS 1\nQUIT" | nc localhost 2121

# –ö —Å–µ—Ä–≤–µ—Ä—É –Ω–∞ –ø–æ—Ä—Ç—É 2122  
echo -e "USER demo\nPASS 1\nQUIT" | nc localhost 2122

# –ö —Å–µ—Ä–≤–µ—Ä—É –Ω–∞ –ø–æ—Ä—Ç—É 2123
echo -e "USER demo\nPASS 1\nQUIT" | nc localhost 2123
```

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ FTP-—Å–µ—Ä–≤–µ—Ä–∞

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Å—Ä–µ–¥—ã FTP-—Å–µ—Ä–≤–µ—Ä–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Docker. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é —Å–ª—É–∂–±—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (`AuthService`), `FtpServer`, `nginx` –∏ `Redis` –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è/—É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏—è–º–∏.

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è

  * [Docker](https://docs.docker.com/get-docker/) —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ —Å–∏—Å—Ç–µ–º–µ.

  * `Dockerfile` –¥–ª—è `Nginx` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ç–µ–∫—É—â–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ –∏–ª–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –æ–±—Ä–∞–∑ `Nginx` –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ Docker Hub.

  * `Dockerfile` –¥–ª—è `AuthService` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ –∞–¥—Ä–µ—Å—É `/FtpServer.Auth/Dockerfile`.
  
  * –ó–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ 
        
    ### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞:
    * `Redis` (–Ω–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
    * `Auth Service` (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç `Redis`)
    * `FTP Servers` (–∑–∞–≤–∏—Å—è—Ç –æ—Ç `Redis` + `Auth Service`)
    * `nginx` (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç `FTP Servers`)
 
-----

## 1\. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx

–≠—Ç–æ—Ç —à–∞–≥ –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –æ–±—Ä–∞–∑–∞ Docker –¥–ª—è `Nginx`.

### –í–∞—Ä–∏–∞–Ω—Ç A: –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞ Docker –¥–ª—è Nginx (–µ—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π Dockerfile)

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π `Dockerfile` –¥–ª—è Nginx –≤ —Ç–µ–∫—É—â–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ, –≤—ã –º–æ–∂–µ—Ç–µ —Å–æ–±—Ä–∞—Ç—å —Å–≤–æ–π –æ–±—Ä–∞–∑:

```bash
sudo docker build -f Dockerfile -t nginx-ftp:docker-ready .
```

### –í–∞—Ä–∏–∞–Ω—Ç B: –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞ Nginx (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –æ–±—Ä–∞–∑)

–í –∫–∞—á–µ—Å—Ç–≤–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –æ–±—Ä–∞–∑ Nginx –∏–∑ Docker Hub:

```bash
docker pull nginx
```

-----

## 2\. –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ç–∏ Docker –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ FTP-—Å–µ—Ä–≤–µ—Ä–∞

–í—ã–¥–µ–ª–µ–Ω–Ω–∞—è –º–æ—Å—Ç–æ–≤–∞—è —Å–µ—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Å–≤—è–∑–∏ –º–µ–∂–¥—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ –ø–æ –∏—Ö –∏–º–µ–Ω–∞–º —Å–ª—É–∂–±.

### –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ç–∏

```bash
docker network create ftp-network
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Ç–∏

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ç—å `ftp-network` —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞:

```bash
docker network ls | grep ftp-network
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

```
NETWORK ID        NAME          DRIVER    SCOPE
<–≤–∞—à_id>          ftp-network   bridge    local
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª–µ–π —Å–µ—Ç–∏ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

–ß—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–∑–¥–∞–Ω–Ω–æ–π —Å–µ—Ç–∏:

```bash
docker network inspect ftp-network
```

-----

## 3\. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Redis

–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø–æ—Å–≤—è—â–µ–Ω —Å–±–æ—Ä–∫–µ –æ–±—Ä–∞–∑–∞ Redis (–µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π) –∏ –∑–∞–ø—É—Å–∫—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ Redis.

### –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞ Docker –¥–ª—è Redis (–µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π, –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `redis:latest`)


```bash

sudo docker build -f redis/Dockerfile -t redis-master:docker-ready .
```

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ Redis

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä Redis, –æ—Ç–∫—Ä—ã–≤ –ø–æ—Ä—Ç 6379 –∏ –ø–æ–¥–∫–ª—é—á–∏–≤ –µ–≥–æ –∫ `ftp-network`.

```bash
sudo docker run -d --name redis -p 6379:6379 --network ftp-network redis:docker-ready
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ Redis

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ Redis —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω:

```bash
docker logs redis
```

-----

## 4\. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ª—É–∂–±—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (Auth Service)

–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –ø–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å–±–æ—Ä–∫—É –∏ –∑–∞–ø—É—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π —Å–ª—É–∂–±—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

### –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞ Docker –¥–ª—è —Å–ª—É–∂–±—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

–°–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑ Docker –¥–ª—è `auth-service` –∏–∑ –µ–≥–æ `Dockerfile`.

```bash
sudo docker build -f FtpServer.Auth/Dockerfile -t auth-service:fixed-port .
```

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å–ª—É–∂–±—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä `auth-service`, –æ—Ç–∫—Ä—ã–≤ –ø–æ—Ä—Ç 5160 –∏ –ø–æ–¥–∫–ª—é—á–∏–≤ –µ–≥–æ –∫ `ftp-network`.

```bash
sudo docker run -d \
--name auth-service \
--network ftp-network \
-p 5160:5160 \
auth-service:fixed-port
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å–ª—É–∂–±—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å–ª—É–∂–±–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω–∞:

```bash
docker logs auth-service
```

-----

## 5\. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å–ª—É–∂–±—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫ Redis

–ö—Ä–∞–π–Ω–µ –≤–∞–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `auth-service` –º–æ–∂–µ—Ç —Å–≤—è–∑—ã–≤–∞—Ç—å—Å—è —Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º `redis`.

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é `ping` (–ø–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞)

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å `ping` –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ `redis` –∏–∑–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ `auth-service`.

```bash
sudo docker exec auth-service ping redis
```

**–û–∂–∏–¥–∞–µ–º—ã–π —É—Å–ø–µ—à–Ω—ã–π –≤—ã–≤–æ–¥:**

```
PING redis 56(84) bytes of data.
64 bytes from redis.ftp-network (172.18.0.2): icmp_seq=1 ttl=64 time=0.039 ms
64 bytes from redis.ftp-network (172.18.0.2): icmp_seq=2 ttl=64 time=0.049 ms
64 bytes from redis.ftp-network (172.18.0.2): icmp_seq=3 ttl=64 time=0.137 ms
...
```

### –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫: –∫–æ–º–∞–Ω–¥–∞ `ping` –Ω–µ –Ω–∞–π–¥–µ–Ω–∞

–ï—Å–ª–∏ –≤—ã —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å —Å –æ—à–∏–±–∫–æ–π `exec: "ping": executable file not found in $PATH`, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —É—Ç–∏–ª–∏—Ç–∞ `ping` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ `auth-service`. –í—ã –º–æ–∂–µ—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ–µ –¥–ª—è —Ü–µ–ª–µ–π –æ—Ç–ª–∞–¥–∫–∏:

1.  **–ü–æ–ª—É—á–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –æ–±–æ–ª–æ—á–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ `auth-service`:**

    ```bash
    sudo docker exec -it auth-service bash
    ```

2.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `iputils-ping` (–¥–ª—è –æ–±—Ä–∞–∑–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ Debian/Ubuntu):**

    ```bash
    # –í–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:
    apt-get update
    apt-get install -y iputils-ping
    ```

    (–ï—Å–ª–∏ –≤–∞—à –æ–±—Ä–∞–∑ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ Alpine, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `apk add --no-cache iputils` –≤–º–µ—Å—Ç–æ –∫–æ–º–∞–Ω–¥ `apt-get`).

3.  **–í—ã–π–¥–∏—Ç–µ –∏–∑ –æ–±–æ–ª–æ—á–∫–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:**

    ```bash
    exit
    ```

4.  **–ü–æ–≤—Ç–æ—Ä–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç `ping`:**

    ```bash
    sudo docker exec auth-service ping redis
    ```

    –¢–µ–ø–µ—Ä—å –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å —É—Å–ø–µ—à–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã `ping`, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –≤—ã—à–µ –≤ —Ä–∞–∑–¥–µ–ª–µ "–û–∂–∏–¥–∞–µ–º—ã–π —É—Å–ø–µ—à–Ω—ã–π –≤—ã–≤–æ–¥".

–û—Ç–ª–∏—á–Ω–æ! üöÄ –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å FTP —Å–µ—Ä–≤–µ—Ä–∞–º–∏.

## üìù **–®–∞–≥ –ó–∞–ø—É—Å–∫–∞–µ–º FTP Servers —Å environment variables**

### **–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ä—ã–µ FTP —Å–µ—Ä–≤–µ—Ä—ã:**

```bash
# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ —Å—Ç–∞—Ä—ã–µ FTP —Å–µ—Ä–≤–µ—Ä—ã
docker stop ftp-server-1 2>/dev/null || true
docker rm ftp-server-1 2>/dev/null || true
```

### **–ó–∞–ø—É—Å–∫–∞–µ–º FTP Server 1:**

```bash
docker run -d \
  --name ftp-server-1 \
  --network ftp-network \
  -e RedisConnectionString=redis:6379 \  # –¥–ª—è –ø—Ä–µ–º–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ appsettings.json
  -e authservice=http://auth-service:5160 \ 
  -e port=2121 \
  ftp-server:fixed

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏
docker logs ftp-server-1
```
### –ü–æ–≤—Ç–æ—Ä–∏–º –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ ftp-server-2, ftp-server-3 ....


### **–ü—Ä–æ–≤–µ—Ä—è–µ–º connectivity –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏:**

```bash
# FTP Server –¥–æ–ª–∂–µ–Ω –≤–∏–¥–µ—Ç—å Redis
docker exec ftp-server-1 ping redis

# FTP Server –¥–æ–ª–∂–µ–Ω –≤–∏–¥–µ—Ç—å Auth Service  
docker exec ftp-server-1 ping auth-service

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ –æ–¥–Ω–æ–π —Å–µ—Ç–∏
docker network inspect ftp-network
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ª–æ–≥–∞—Ö FTP —Å–µ—Ä–≤–µ—Ä–æ–≤:**
```
‚úÖ Redis connected: redis:6379
üöÄ FTP Server started on port 2121
```
–û—Ç–ª–∏—á–Ω–æ! üéâ –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º—É —à–∞–≥—É - nginx load balancer.

## üìù **–®–∞–≥: –ó–∞–ø—É—Å–∫–∞–µ–º nginx Load Balancer (—Ñ–∏–Ω–∞–ª)**

### **–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ä—ã–π nginx:**

```bash
# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ä—ã–π nginx –µ—Å–ª–∏ –µ—Å—Ç—å
docker stop nginx-ftp 2>/dev/null || true
docker rm nginx-ftp 2>/dev/null || true
```

### **–ó–∞–ø—É—Å–∫–∞–µ–º nginx –≤ ftp-network:**

```bash
docker run -d \
  --name nginx-lb \
  --network ftp-network \
  -p 21:21 \
  nginx-ftp:docker-ready

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏ nginx
docker logs nginx-lb
```

### **–ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ nginx –≤–∏–¥–∏—Ç –≤—Å–µ FTP —Å–µ—Ä–≤–µ—Ä—ã:**

```bash
# nginx –¥–æ–ª–∂–µ–Ω –≤–∏–¥–µ—Ç—å –≤—Å–µ FTP —Å–µ—Ä–≤–µ—Ä—ã
docker exec nginx-lb ping ftp-server-1
docker exec nginx-lb ping ftp-server-2  
docker exec nginx-lb ping ftp-server-3

# –°–º–æ—Ç—Ä–∏–º —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker ps
```

### **–§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã:**

```bash
# –°–º–æ—Ç—Ä–∏–º –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ –Ω–∞—à–µ–π —Å–µ—Ç–∏
docker network inspect ftp-network

# –î–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å 6 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:
# - redis
# - auth-service  
# - ftp-server-1, ftp-server-2, ftp-server-3
# - nginx-lb
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
CONTAINER ID   IMAGE                      STATUS
xxx            ftp-redis:latest          Up
xxx            auth-service:port-fixed   Up  
xxx            ftp-server:fixed          Up
xxx            ftp-server:fixed          Up
xxx            ftp-server:fixed          Up
xxx            nginx-ftp:docker-ready    Up
```

## üß™ **–®–∞–≥ : –¢–µ—Å—Ç–∏—Ä—É–µ–º distributed FTP —Å–∏—Å—Ç–µ–º—É**

### **–¢–µ—Å—Ç 1: –ü—Ä–æ—Å—Ç–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ**

```bash
# –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ nginx load balancer
telnet localhost 21
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
220 Welcome to Basic FTP Server v1.0.
Input "USER demo" or "USER test" and any password
```

### **–¢–µ—Å—Ç 2: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**

```
USER demo
331 Password required  
PASS 1
230 Login successful
```
‚úÖ –ß—Ç–æ –º—ã —Å–æ–∑–¥–∞–ª–∏:
–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è Distributed FTP Server Architecture:

üîÑ Load Balancing Layer: nginx —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –º–µ–∂–¥—É FTP —Å–µ—Ä–≤–µ—Ä–∞–º–∏

üîê Session Management: Redis —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–µ—Å—Å–∏–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–∞–º–∏

üõ°Ô∏è Authentication: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π Auth Service

üìÅ User Isolation: –ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–∞–ø–∫–µ

üê≥ Containerized: –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö

üåê Docker Networking: –°–µ—Ä–≤–∏—Å—ã –æ–±—â–∞—é—Ç—Å—è –ø–æ –∏–º–µ–Ω–∞–º

 ## –ì–æ—Ç–æ–≤—ã –∫ –æ–±–ª–∞—á–Ω–æ–º—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!
–¢–µ–ø–µ—Ä—å —É –Ω–∞—Å –µ—Å—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ Play With Docker –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º cloud –æ–∫—Ä—É–∂–µ–Ω–∏–∏.